//Codigo para notificar al correo cada vez que se abre la puerta.
//O bien cada vez que la señal entre el fotodiodo y el transistor detecte distorsión o se interrumpa.

//Se utilizarán las bibliotecas del módulo wifi del ESP8266.
//Además para enviar un correo desde arduino se deberá realizar mediante un proveedor SMTP.
//En este código se utilizará Thinger.io.

# define  _DEBUG_
# define  DISABLE_TLS
# include  <ESP8266WiFi.h>
# include  <ThingerESP8266.h>

# define  USUARIO  "  "
# define  ID  "  "
# define  CREDENCIAL  "  "

# define   NOMBRE_DE_WIFI  " nombre_wifi "
# define  CONTRASEÑA  " contraseña wifi "

ThingerESP8266 modulo (USUARIO, ID, CREDENCIAL);
//Se indica el pin de entrada que es el 4.
int pushPin = 4 ;

//Además se introduce la variable para leer el estado del pin.
//Cuando el valor es igual a cero, la puerta está abierta
int val = 0 ; 
 

//Esto se añade en el void setup principal
  
  thing.add_wifi(NOMBRE_DE_WIFI, CONTRASEÑA);
  
  //Se declara el pin 4 como entrada.
  pinMode (pushPin, INPUT_PULLUP); 
  Serial.begin ( 9600 );

 
//Esto se añade en el voidloop principal
//Condición que verifica si la puerta se separó y "!0" indica que está cerrada.
   if (val == 0) {          
    
      thing.handle ();
      //El siguiente comando se utiliza para indicar el msj que recibirá el usuario.
      thing.call_endpoint ( " El presente correo le notifica que la puerta de su hogar ha sido abierta, tome las acciones necesarias. " );
      //Se indica el valor de retraso, no es mucho tiempo que tarda en enviar el correo.
      delay ( 5000 );
  }

